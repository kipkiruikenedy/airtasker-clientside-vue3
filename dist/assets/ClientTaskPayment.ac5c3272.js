import{u as $,e as r,j as a,f as _,H as q,o as h,c as f,b as t,d,t as l,y as M,z as Q,h as J,i as p,S as b}from"./index.f9fba2aa.js";const N={class:"container mx-auto"},W=["onSubmit"],X={class:"text-red-900"},Z={class:"font-semibold"},j={class:"font-semibold"},D={class:"font-semibold"},K=t("p",null,"Your money will be on hold untill the tasker completes the task. ",-1),R={class:"my-10 rounded-md border border-gray-300 p-4",ref:"cardWrapper"},z=["disabled"],E={class:"flex space-x-1"},F=t("p",null,"pay",-1),H={class:"font-semibold"},U=t("p",null,"for the task",-1),G={key:0,class:"mt-2"},L=t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"}," please wait...")],-1),O=[L],at={__name:"ClientTaskPayment",setup(tt){const y=$().user.id;r([]),r([]),a(!1);let u=Stripe("pk_test_51MptVhBQovItJ3xem1WVQAsYny0SKYmYJBrSU3QPn33MwZmrYChJBZm7tqmX7Xx43AAxCgcmrAco0iuZKTX53cS800t2QmFabq"),k=u.elements(),s;const i=J();p();const v=a(""),x=a(""),g=a(""),n=a(!1),w=i.params.id,e=r({amount:null,fees:null,amountPayable:null}),S=i.query.tasker_id;_.get(`/api/tasks/${w}`).then(o=>{e.amount=o.data.amount,e.amountPayable=o.data.amountPayable,e.tasker_id=o.data.tasker_id,e.client_id=o.data.client_id,e.fees=o.data.fees,console.log(e.fees)}).catch(o=>{console.error(o)});const C=()=>{n.value=!0,u.createToken(s).then(function(o){const m=o.token.id,Y=i.params.id,P=y,A=Y,T=S,I=e.amountPayable;b.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, submit payment!"}).then(V=>{V.isConfirmed&&_.post("/api/client-pay-task",{stripe_token:m,amount:I,tasker_id:T,task_id:A,client_id:P}).then(function(c){console.log(c.data),v.value="",x.value="",g.value="",b.fire({icon:"",title:"Congratulations! You payment have succesfully been submitted",text:"Your money will be on hold untill the tasker completes the task!",footer:'<a href="">Want to read more about payment?</a>'}),s.clear(),n.value=!1,p().push("/client-active-task")}).catch(function(c){console.log(c),n.value=!1})})})},B=()=>{s||(s=k.create("card",{style:{base:{display:"flex",flexDirection:"column",justifyContent:"space-between"},postalCode:{display:"none"}}}),s.mount(document.querySelector("#card")))};return a(null),q(B),(o,m)=>(h(),f("div",N,[t("form",{class:"max-w-md mx-auto bg-white p-8 my-10 rounded-lg shadow-lg border",onSubmit:Q(C,["prevent"])},[t("p",X,[d("You are about to pay "),t("span",Z,"$"+l(e.amount),1),d(" for the task and a fee of "),t("span",j,"$"+l(e.fees),1),d(" . Total="),t("span",D,"$"+l(e.amountPayable),1)]),K,t("div",R,[t("div",{ref_key:"card",ref:s,id:"card"},null,512)],512),t("button",{type:"submit",disabled:n.value,class:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-full focus:outline-none focus:shadow-outline"},[t("div",E,[F,t("span",H,"$"+l(e.amountPayable),1),U])],8,z),n.value?(h(),f("div",G,O)):M("",!0)],40,W)]))}};export{at as default};
